import{s as ye,f as Ye,n as q,o as Ze,r as qe,e as $e}from"../chunks/scheduler.3f07874a.js";import{S as Je,i as Ge,g as u,s as y,h as f,j as b,c as w,x as H,f as o,k as d,a as E,y as n,z as et,m as ne,n as re,o as me,e as Ae,A as _e,B as ae,C as tt,t as ce,b as Ke,d as oe,l as st,p as Qe,r as lt,u as at,v as nt,w as rt}from"../chunks/index.bce4ad42.js";import{e as Re}from"../chunks/each.e59479a4.js";import{P as Ee}from"../chunks/public.aa8ed6af.js";import{u as it}from"../chunks/storage.8c515f7d.js";import{i as je}from"../chunks/navigation.fbbcb2c9.js";async function ct({fetch:c,parent:e}){return{}}const St=Object.freeze(Object.defineProperty({__proto__:null,load:ct},Symbol.toStringTag,{value:"Module"})),ot=""+new URL("../assets/spreadsheet.69959a69.png",import.meta.url).href;function Be(c,e,t){const s=c.slice();return s[1]=e[t],s}function ze(c){let e,t,s=c[1].title+"",l,h;return{c(){e=u("p"),t=u("a"),l=ne(s),this.h()},l(a){e=f(a,"P",{});var r=b(e);t=f(r,"A",{href:!0});var k=b(t);l=re(k,s),k.forEach(o),r.forEach(o),this.h()},h(){d(t,"href",h="/sheet/"+c[1].sid+"?readToken="+c[1].readToken+"&writeToken="+c[1].modifyToken)},m(a,r){E(a,e,r),n(e,t),n(t,l)},p(a,r){r&1&&s!==(s=a[1].title+"")&&me(l,s),r&1&&h!==(h="/sheet/"+a[1].sid+"?readToken="+a[1].readToken+"&writeToken="+a[1].modifyToken)&&d(t,"href",h)},d(a){a&&o(e)}}}function dt(c){let e,t,s,l,h,a="Sheets created by you:",r,k,D=Re(c[0]),_=[];for(let v=0;v<D.length;v+=1)_[v]=ze(Be(c,D,v));return{c(){e=u("div"),t=u("img"),l=y(),h=u("p"),h.textContent=a,r=y(),k=u("div");for(let v=0;v<_.length;v+=1)_[v].c();this.h()},l(v){e=f(v,"DIV",{});var m=b(e);t=f(m,"IMG",{width:!0,src:!0,alt:!0}),l=w(m),h=f(m,"P",{"data-svelte-h":!0}),H(h)!=="svelte-nwv7gw"&&(h.textContent=a),r=w(m),k=f(m,"DIV",{class:!0});var p=b(k);for(let O=0;O<_.length;O+=1)_[O].l(p);p.forEach(o),m.forEach(o),this.h()},h(){d(t,"width","64"),Ye(t.src,s=ot)||d(t,"src",s),d(t,"alt","spreadsheet"),d(k,"class","content is-medium has-text-centered")},m(v,m){E(v,e,m),n(e,t),n(e,l),n(e,h),n(e,r),n(e,k);for(let p=0;p<_.length;p+=1)_[p]&&_[p].m(k,null)},p(v,[m]){if(m&1){D=Re(v[0]);let p;for(p=0;p<D.length;p+=1){const O=Be(v,D,p);_[p]?_[p].p(O,m):(_[p]=ze(O),_[p].c(),_[p].m(k,null))}for(;p<_.length;p+=1)_[p].d(1);_.length=D.length}},i:q,o:q,d(v){v&&o(e),et(_,v)}}}function ut(c,e,t){let{sheets:s=[]}=e;return Ze(async()=>{const h=await(await fetch(`${Ee}/sheets`,{credentials:"include"})).json();console.log(h),t(0,s=h)}),c.$$set=l=>{"sheets"in l&&t(0,s=l.sheets)},[s]}class ft extends Je{constructor(e){super(),Ge(this,e,ut,dt,ye,{sheets:0})}}const ht=""+new URL("../assets/file-upload.156694fe.png",import.meta.url).href,vt=""+new URL("../assets/edit.cc61a753.png",import.meta.url).href,pt=""+new URL("../assets/share.f4c802a8.png",import.meta.url).href;function Fe(c){let e,t;return{c(){e=u("p"),t=ne(c[0]),this.h()},l(s){e=f(s,"P",{style:!0});var l=b(e);t=re(l,c[0]),l.forEach(o),this.h()},h(){st(e,"color","red")},m(s,l){E(s,e,l),n(e,t)},p(s,l){l&1&&me(t,s[0])},d(s){s&&o(e)}}}function _t(c){let e,t="Welcome to the Cell!";return{c(){e=u("h3"),e.textContent=t,this.h()},l(s){e=f(s,"H3",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1yubcx4"&&(e.textContent=t),this.h()},h(){d(e,"class","title is-3")},m(s,l){E(s,e,l)},p:q,d(s){s&&o(e)}}}function mt(c){let e,t,s=c[5].username+"",l,h;return{c(){e=u("h2"),t=ne("Welcome back, "),l=ne(s),h=ne("!"),this.h()},l(a){e=f(a,"H2",{class:!0});var r=b(e);t=re(r,"Welcome back, "),l=re(r,s),h=re(r,"!"),r.forEach(o),this.h()},h(){d(e,"class","title is-3")},m(a,r){E(a,e,r),n(e,t),n(e,l),n(e,h)},p(a,r){r&32&&s!==(s=a[5].username+"")&&me(l,s)},d(a){a&&o(e)}}}function We(c){let e=c[3][0].name+"",t;return{c(){t=ne(e)},l(s){t=re(s,e)},m(s,l){E(s,t,l)},p(s,l){l&8&&e!==(e=s[3][0].name+"")&&me(t,e)},d(s){s&&o(t)}}}function bt(c){let e,t=`<nav class="level"><div class="level-item has-text-centered"><div><p class="heading">Upload excel file</p> <p class="title">Upload</p> <img alt="" src="${ht}" width="32px"/></div></div> <div class="level-item has-text-centered"><div><p class="heading">Create the sheet manually</p> <p class="title">Create</p> <img width="32px" src="${vt}" alt=""/></div></div> <div class="level-item has-text-centered"><div><p class="heading">Work together.</p> <p class="title">Collaborate</p> <img width="32px" src="${pt}" alt=""/></div></div></nav>`,s,l,h='<div class="columns is-centered"><div class="column is-half has-text-centered"><p class="is-size-4">Ready to start?</p></div></div> <nav class="level"><div class="level-item has-text-centered"><div><a class="button is-medium is-link" href="/signin">Sign In</a></div></div> <div class="level-item has-text-centered"><div><a class="button is-medium is-primary" href="/signup">Sign Up</a></div></div></nav>';return{c(){e=u("section"),e.innerHTML=t,s=y(),l=u("section"),l.innerHTML=h,this.h()},l(a){e=f(a,"SECTION",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1juf026"&&(e.innerHTML=t),s=w(a),l=f(a,"SECTION",{class:!0,"data-svelte-h":!0}),H(l)!=="svelte-1eistpp"&&(l.innerHTML=h),this.h()},h(){d(e,"class","section"),d(l,"class","section")},m(a,r){E(a,e,r),E(a,s,r),E(a,l,r)},p:q,i:q,o:q,d(a){a&&(o(e),o(s),o(l))}}}function kt(c){let e,t,s,l=c[4],h,a,r,k,D="Create new sheet",_,v,m,p,O="Upload new sheet",C,A,N,g=Xe();return{c(){e=u("section"),t=u("div"),s=u("div"),g.c(),h=y(),a=u("div"),r=u("div"),k=u("button"),k.textContent=D,_=y(),v=u("div"),m=u("div"),p=u("button"),p.textContent=O,this.h()},l(M){e=f(M,"SECTION",{class:!0});var I=b(e);t=f(I,"DIV",{class:!0});var x=b(t);s=f(x,"DIV",{class:!0});var j=b(s);g.l(j),j.forEach(o),x.forEach(o),h=w(I),a=f(I,"DIV",{class:!0});var ie=b(a);r=f(ie,"DIV",{class:!0});var K=b(r);k=f(K,"BUTTON",{class:!0,"data-svelte-h":!0}),H(k)!=="svelte-1hbazlb"&&(k.textContent=D),K.forEach(o),ie.forEach(o),_=w(I),v=f(I,"DIV",{class:!0});var U=b(v);m=f(U,"DIV",{class:!0});var B=b(m);p=f(B,"BUTTON",{class:!0,"data-svelte-h":!0}),H(p)!=="svelte-1rllgnr"&&(p.textContent=O),B.forEach(o),U.forEach(o),I.forEach(o),this.h()},h(){d(s,"class","column is-half has-text-centered"),d(t,"class","columns is-centered"),d(k,"class","button is-info"),d(r,"class","column is-half has-text-centered"),d(a,"class","columns is-centered"),d(p,"class","button is-info"),d(m,"class","column is-half has-text-centered"),d(v,"class","columns is-centered"),d(e,"class","section")},m(M,I){E(M,e,I),n(e,t),n(t,s),g.m(s,null),n(e,h),n(e,a),n(a,r),n(r,k),n(e,_),n(e,v),n(v,m),n(m,p),C=!0,A||(N=[ae(k,"click",c[10]),ae(p,"click",c[11])],A=!0)},p(M,I){I&16&&ye(l,l=M[4])?(Qe(),ce(g,1,1,q),Ke(),g=Xe(),g.c(),oe(g,1),g.m(s,null)):g.p(M,I)},i(M){C||(oe(g),C=!0)},o(M){ce(g),C=!1},d(M){M&&o(e),g.d(M),A=!1,qe(N)}}}function Xe(c){let e,t;return e=new ft({}),{c(){lt(e.$$.fragment)},l(s){at(e.$$.fragment,s)},m(s,l){nt(e,s,l),t=!0},p:q,i(s){t||(oe(e.$$.fragment,s),t=!0)},o(s){ce(e.$$.fragment,s),t=!1},d(s){rt(e,s)}}}function gt(c){let e,t,s,l,h,a,r,k="",D,_,v,m,p="Create new sheet",O,C,A,N,g,M='<div class="field"><p class="control"><input class="input" name="title" type="text" placeholder="New sheet"/></p></div> <div class="field"><p class="control"><input type="submit" value="Create" class="button is-success"/></p></div>',I,x,j,ie="",K,U,B,we='<p class="modal-card-title">Upload new file</p>',be,Q,Y,z,F,ke,J,Ie='<span class="file-label">Upload XLSX file:</span>',ge,G,Te,Z,W,Le="Upload",de,V,P,$,ee,Ce,Se,L=c[0]&&Fe(c);function De(i,T){return i[5].username?mt:_t}let ue=De(c),R=ue(c),S=c[3]&&c[3].length>0&&We(c);const Me=[kt,bt],X=[];function Oe(i,T){return i[5].username?0:1}return V=Oe(c),P=X[V]=Me[V](c),{c(){L&&L.c(),e=y(),t=u("section"),s=u("div"),l=u("div"),R.c(),h=y(),a=u("div"),r=u("div"),r.innerHTML=k,D=y(),_=u("div"),v=u("header"),m=u("p"),m.textContent=p,O=y(),C=u("button"),A=y(),N=u("section"),g=u("form"),g.innerHTML=M,I=y(),x=u("div"),j=u("div"),j.innerHTML=ie,K=y(),U=u("div"),B=u("header"),B.innerHTML=we,be=y(),Q=u("section"),Y=u("div"),z=u("label"),F=u("input"),ke=y(),J=u("span"),J.innerHTML=Ie,ge=y(),G=u("span"),S&&S.c(),Te=y(),Z=u("footer"),W=u("button"),W.textContent=Le,de=y(),P.c(),$=Ae(),this.h()},l(i){L&&L.l(i),e=w(i),t=f(i,"SECTION",{class:!0});var T=b(t);s=f(T,"DIV",{class:!0});var te=b(s);l=f(te,"DIV",{class:!0});var xe=b(l);R.l(xe),xe.forEach(o),te.forEach(o),T.forEach(o),h=w(i),a=f(i,"DIV",{class:!0});var fe=b(a);r=f(fe,"DIV",{class:!0,"data-svelte-h":!0}),H(r)!=="svelte-kghszr"&&(r.innerHTML=k),D=w(fe),_=f(fe,"DIV",{class:!0});var he=b(_);v=f(he,"HEADER",{class:!0});var ve=b(v);m=f(ve,"P",{class:!0,"data-svelte-h":!0}),H(m)!=="svelte-1synbh9"&&(m.textContent=p),O=w(ve),C=f(ve,"BUTTON",{class:!0,"aria-label":!0}),b(C).forEach(o),ve.forEach(o),A=w(he),N=f(he,"SECTION",{class:!0});var Ne=b(N);g=f(Ne,"FORM",{"data-svelte-h":!0}),H(g)!=="svelte-1rlx41s"&&(g.innerHTML=M),Ne.forEach(o),he.forEach(o),fe.forEach(o),I=w(i),x=f(i,"DIV",{class:!0});var pe=b(x);j=f(pe,"DIV",{class:!0,"data-svelte-h":!0}),H(j)!=="svelte-kghszr"&&(j.innerHTML=ie),K=w(pe),U=f(pe,"DIV",{class:!0});var se=b(U);B=f(se,"HEADER",{class:!0,"data-svelte-h":!0}),H(B)!=="svelte-17jxaog"&&(B.innerHTML=we),be=w(se),Q=f(se,"SECTION",{class:!0});var Ue=b(Q);Y=f(Ue,"DIV",{class:!0});var He=b(Y);z=f(He,"LABEL",{class:!0});var le=b(z);F=f(le,"INPUT",{class:!0,type:!0,name:!0,id:!0}),ke=w(le),J=f(le,"SPAN",{class:!0,"data-svelte-h":!0}),H(J)!=="svelte-15d2tf3"&&(J.innerHTML=Ie),ge=w(le),G=f(le,"SPAN",{class:!0});var Ve=b(G);S&&S.l(Ve),Ve.forEach(o),le.forEach(o),He.forEach(o),Ue.forEach(o),Te=w(se),Z=f(se,"FOOTER",{class:!0});var Pe=b(Z);W=f(Pe,"BUTTON",{class:!0,"data-svelte-h":!0}),H(W)!=="svelte-1jgcc4e"&&(W.textContent=Le),Pe.forEach(o),se.forEach(o),pe.forEach(o),de=w(i),P.l(i),$=Ae(),this.h()},h(){d(l,"class","column is-half has-text-centered"),d(s,"class","columns is-centered"),d(t,"class","section"),d(r,"class","modal-background"),d(m,"class","modal-card-title"),d(C,"class","delete"),d(C,"aria-label","close"),d(v,"class","modal-card-head"),d(N,"class","modal-card-body"),d(_,"class","modal-card"),d(a,"class","modal"),_e(a,"is-active",c[1]),d(j,"class","modal-background"),d(B,"class","modal-card-head"),d(F,"class","file-input"),d(F,"type","file"),d(F,"name","file"),d(F,"id","file"),d(J,"class","file-cta"),d(G,"class","file-name"),d(z,"class","file-label"),d(Y,"class","file"),d(Q,"class","modal-card-body"),d(W,"class","button is-success"),d(Z,"class","modal-card-foot"),d(U,"class","modal-card"),d(x,"class","modal"),_e(x,"is-active",c[2])},m(i,T){L&&L.m(i,T),E(i,e,T),E(i,t,T),n(t,s),n(s,l),R.m(l,null),E(i,h,T),E(i,a,T),n(a,r),n(a,D),n(a,_),n(_,v),n(v,m),n(v,O),n(v,C),n(_,A),n(_,N),n(N,g),E(i,I,T),E(i,x,T),n(x,j),n(x,K),n(x,U),n(U,B),n(U,be),n(U,Q),n(Q,Y),n(Y,z),n(z,F),n(z,ke),n(z,J),n(z,ge),n(z,G),S&&S.m(G,null),n(U,Te),n(U,Z),n(Z,W),E(i,de,T),X[V].m(i,T),E(i,$,T),ee=!0,Ce||(Se=[ae(C,"click",c[8]),ae(g,"submit",tt(c[6])),ae(F,"change",c[9]),ae(W,"click",c[7])],Ce=!0)},p(i,[T]){i[0]?L?L.p(i,T):(L=Fe(i),L.c(),L.m(e.parentNode,e)):L&&(L.d(1),L=null),ue===(ue=De(i))&&R?R.p(i,T):(R.d(1),R=ue(i),R&&(R.c(),R.m(l,null))),(!ee||T&2)&&_e(a,"is-active",i[1]),i[3]&&i[3].length>0?S?S.p(i,T):(S=We(i),S.c(),S.m(G,null)):S&&(S.d(1),S=null),(!ee||T&4)&&_e(x,"is-active",i[2]);let te=V;V=Oe(i),V===te?X[V].p(i,T):(Qe(),ce(X[te],1,1,()=>{X[te]=null}),Ke(),P=X[V],P?P.p(i,T):(P=X[V]=Me[V](i),P.c()),oe(P,1),P.m($.parentNode,$))},i(i){ee||(oe(P),ee=!0)},o(i){ce(P),ee=!1},d(i){i&&(o(e),o(t),o(h),o(a),o(I),o(x),o(de),o($)),L&&L.d(i),R.d(),S&&S.d(),X[V].d(i),Ce=!1,qe(Se)}}}function Tt(c,e,t){let s;$e(c,it,C=>t(5,s=C));let l,h=!1,a=!1,r,k={};async function D(C){let N=new FormData(C.currentTarget).get("title");const g=await fetch(`${Ee}/sheets/create`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:N})});if(g.ok){await je(),t(1,h=!1),t(4,k={});return}t(1,h=!1),t(0,l=await g.text());try{t(0,l=JSON.parse(l).data.error)}catch{}}async function _(){if(!r||r.length===0)return;let C=new FormData;C.append("sheet",r[0]);const A=await fetch(`${Ee}/sheets/upload`,{method:"POST",body:C,credentials:"include"});if(A.ok){t(3,r=null),t(2,a=!1),t(4,k={}),await je();return}t(2,a=!1),t(0,l=await A.text());try{t(0,l=JSON.parse(l).detail.error)}catch(N){console.log(N)}}const v=()=>t(1,h=!1);function m(){r=this.files,t(3,r)}return[l,h,a,r,k,s,D,_,v,m,()=>t(1,h=!0),()=>t(2,a=!0)]}class Dt extends Je{constructor(e){super(),Ge(this,e,Tt,gt,ye,{})}}export{Dt as component,St as universal};

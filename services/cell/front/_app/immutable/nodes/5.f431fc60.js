import{s as re}from"../chunks/scheduler.3f07874a.js";import{S as le,i as ie,g as l,s as V,r as X,h as i,j as f,f as o,c as b,x as Y,u as Z,k as e,a as M,y as s,v as ee,B as oe,C as ce,d as te,t as se,w as ae,m as de,n as ue,o as fe}from"../chunks/index.bce4ad42.js";import{g as pe,i as me}from"../chunks/navigation.cb5fd4ff.js";import{P as he,L as ve}from"../chunks/LockClosed.62f18369.js";import{P as _e}from"../chunks/public.aa8ed6af.js";import{u as ge}from"../chunks/storage.8c515f7d.js";function ne(_){let a,u,t;return{c(){a=l("div"),u=l("div"),t=de(_[0]),this.h()},l(r){a=i(r,"DIV",{class:!0});var p=f(a);u=i(p,"DIV",{class:!0});var v=f(u);t=ue(v,_[0]),v.forEach(o),p.forEach(o),this.h()},h(){e(u,"class","notification is-danger"),e(a,"class","container")},m(r,p){M(r,a,p),s(a,u),s(u,t)},p(r,p){p&1&&fe(t,r[0])},d(r){r&&o(a)}}}function $e(_){let a,u,t,r,p='<div class="column is-half has-text-centered"><p class="is-size-4">Let&#39;s signin.</p></div>',v,g,$,c,m,h,E,U,D,I,H,C,w,P,j,L,S,B,T,J='<p class="control"><input type="submit" value="SignIn" class="button is-success"/></p>',x,F,R,d=_[0]&&ne(_);return I=new he({}),S=new ve({}),{c(){a=l("section"),d&&d.c(),u=V(),t=l("section"),r=l("div"),r.innerHTML=p,v=V(),g=l("div"),$=l("div"),c=l("form"),m=l("div"),h=l("p"),E=l("input"),U=V(),D=l("span"),X(I.$$.fragment),H=V(),C=l("div"),w=l("p"),P=l("input"),j=V(),L=l("span"),X(S.$$.fragment),B=V(),T=l("div"),T.innerHTML=J,this.h()},l(n){a=i(n,"SECTION",{class:!0});var y=f(a);d&&d.l(y),y.forEach(o),u=b(n),t=i(n,"SECTION",{class:!0});var k=f(t);r=i(k,"DIV",{class:!0,"data-svelte-h":!0}),Y(r)!=="svelte-15twxn6"&&(r.innerHTML=p),v=b(k),g=i(k,"DIV",{class:!0});var q=f(g);$=i(q,"DIV",{class:!0});var z=f($);c=i(z,"FORM",{});var N=f(c);m=i(N,"DIV",{class:!0});var G=f(m);h=i(G,"P",{class:!0});var O=f(h);E=i(O,"INPUT",{class:!0,name:!0,type:!0,placeholder:!0}),U=b(O),D=i(O,"SPAN",{class:!0});var K=f(D);Z(I.$$.fragment,K),K.forEach(o),O.forEach(o),G.forEach(o),H=b(N),C=i(N,"DIV",{class:!0});var Q=f(C);w=i(Q,"P",{class:!0});var A=f(w);P=i(A,"INPUT",{class:!0,name:!0,type:!0,placeholder:!0}),j=b(A),L=i(A,"SPAN",{class:!0});var W=f(L);Z(S.$$.fragment,W),W.forEach(o),A.forEach(o),Q.forEach(o),B=b(N),T=i(N,"DIV",{class:!0,"data-svelte-h":!0}),Y(T)!=="svelte-8i1fac"&&(T.innerHTML=J),N.forEach(o),z.forEach(o),q.forEach(o),k.forEach(o),this.h()},h(){e(a,"class","section"),e(r,"class","columns is-centered"),e(E,"class","input"),e(E,"name","username"),e(E,"type","text"),e(E,"placeholder","Username"),e(D,"class","icon is-small is-left"),e(h,"class","control has-icons-left has-icons-right"),e(m,"class","field"),e(P,"class","input"),e(P,"name","password"),e(P,"type","password"),e(P,"placeholder","Password"),e(L,"class","icon is-small is-left"),e(w,"class","control has-icons-left"),e(C,"class","field"),e(T,"class","field"),e($,"class","column is-half has-text-centered"),e(g,"class","columns is-centered"),e(t,"class","section")},m(n,y){M(n,a,y),d&&d.m(a,null),M(n,u,y),M(n,t,y),s(t,r),s(t,v),s(t,g),s(g,$),s($,c),s(c,m),s(m,h),s(h,E),s(h,U),s(h,D),ee(I,D,null),s(c,H),s(c,C),s(C,w),s(w,P),s(w,j),s(w,L),ee(S,L,null),s(c,B),s(c,T),x=!0,F||(R=oe(c,"submit",ce(_[1])),F=!0)},p(n,[y]){n[0]?d?d.p(n,y):(d=ne(n),d.c(),d.m(a,null)):d&&(d.d(1),d=null)},i(n){x||(te(I.$$.fragment,n),te(S.$$.fragment,n),x=!0)},o(n){se(I.$$.fragment,n),se(S.$$.fragment,n),x=!1},d(n){n&&(o(a),o(u),o(t)),d&&d.d(),ae(I),ae(S),F=!1,R()}}}function Ee(_,a,u){let t;async function r(p){const v=new FormData(p.currentTarget);let g=v.get("username"),$=v.get("password");try{const c=await fetch(`${_e}/signin`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({login:g,password:$})});if(c.ok){let m=await c.json(),h={uid:m.data.uid,username:m.data.username};ge.update(E=>h),await pe("/",{invalidateAll:!0});return}u(0,t=await c.text());try{u(0,t=JSON.parse(t).data.error)}catch{}}catch(c){u(0,t=c.toString())}await me()}return[t,r]}class De extends le{constructor(a){super(),ie(this,a,Ee,$e,re,{})}}export{De as component};
